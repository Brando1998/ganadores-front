import './polyfills.server.mjs';
import{x as s,y as u}from"./chunk-OZKU5ZKH.mjs";import{U as g,Z as f,ic as S}from"./chunk-GRPJ7PLL.mjs";var a=class{static toDate(t){var r=t?new Date(parseInt(t)*1e3):!1;return r}static sessionLifeTimeToUnix(t){let r=new Date;return r.setMinutes(r.getMinutes()+t),Math.floor(r.getTime()/1e3).toString()}static getCurrentURL(){return window.location.href}static parseJwt(t){var r=t.split(".")[1],e=r.replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(window.atob(e).split("").map(function(l){return"%"+("00"+l.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(o)}};var w=(()=>{let t=class t{constructor(e){this.http=e}login(e){return this.http.post(u.api+"/auth/login",e)}logout(){localStorage.clear()}saveUser(e){localStorage.setItem(s.USER,e)}getUser(){let e=this.getAccessToken()?JSON.parse(this.getAccessToken()):null,o=e?a.parseJwt(e.access_token):!1;if(o)return o}hasAccess(){let e=!1,o=!1,l=!1,c=0,p=new Date,m=a.toDate(this.getSessionLifetime()?this.getSessionLifetime():!1);if(m){e=!0;let E=new Date(m),n=Math.round((E.getTime()-p.getTime())/(60*1e3));console.log("remaining_session:",n),n>0?(c=n,n<30&&(o=!0)):(c=.01,this.logout())}return{active:e,message:l,minutes:c,refresh:o}}saveAccessToken(e){localStorage.removeItem(s.ACCESS_TOKEN_KEY),localStorage.setItem(s.ACCESS_TOKEN_KEY,e)}saveRefreshToken(e){localStorage.removeItem(s.REFRESH_TOKEN_KEY),localStorage.setItem(s.REFRESH_TOKEN_KEY,e)}getAccessToken(){return localStorage.getItem(s.ACCESS_TOKEN_KEY)}getRefreshToken(){return localStorage.getItem(s.REFRESH_TOKEN_KEY)}saveSessionLifetime(e){localStorage.setItem(s.SESSION_LIFETIME,e)}getSessionLifetime(){return localStorage.getItem(s.SESSION_LIFETIME)}};t.\u0275fac=function(o){return new(o||t)(f(S))},t.\u0275prov=g({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();export{a,w as b};
